# 横屏选集弹窗文字显示修复说明

## 🎯 问题描述

在本地播放功能中，当设备处于横屏模式时，选集弹窗中的按钮没有显示文字内容，导致用户无法识别各个集数。

## 🔧 修复内容

### 1. SeriesAdapter.java 修复
- **移除ShadowLayout的文字绑定冲突**：去除可能覆盖文字颜色的属性
- **强制设置文字颜色**：使用`post()`方法确保颜色设置不被覆盖
- **优化横屏显示**：调整横屏模式下的文字大小
- **添加数据验证**：确保文字内容不为空

### 2. item_series.xml 布局修复
- **移除冲突属性**：删除`hl_bindTextView`、`hl_textColor_true`等可能冲突的属性
- **优化布局参数**：调整padding和最小高度
- **确保可见性**：明确设置TextView的可见性

### 3. AllLocalSeriesDialog.java 优化
- **添加调试日志**：监控数据传递过程
- **优化网格布局**：根据屏幕方向调整列数

## 📱 修复后的行为

### 竖屏模式
- 弹窗从底部弹出
- 4列网格布局
- 文字大小：14sp
- 文字颜色：深灰色（#333333）

### 横屏模式
- 弹窗从右侧弹出
- 6列网格布局
- 文字大小：12sp
- 文字颜色：深灰色（#333333）

### 选中状态
- 背景：主题色
- 文字颜色：白色
- 所有模式下都保持一致

## 🔍 技术细节

### 问题根源
1. **ShadowLayout属性冲突**：`hl_bindTextView`属性会自动管理TextView的颜色
2. **颜色设置时机**：在ShadowLayout设置选中状态后，颜色可能被重置
3. **横屏特殊处理**：横屏模式下的布局变化可能影响文字显示

### 解决方案
```java
// 使用post()方法延迟设置颜色，确保不被覆盖
tvSeries.post(() -> {
    if (item.selected) {
        tvSeries.setTextColor(Color.WHITE);
    } else {
        tvSeries.setTextColor(Color.parseColor("#333333"));
    }
});
```

### 布局优化
```xml
<!-- 移除可能冲突的ShadowLayout属性 -->
<com.lihang.ShadowLayout
    app:hl_cornerRadius="8dp"
    app:hl_layoutBackground="@color/item_series_bg_light"
    app:hl_layoutBackground_true="?attr/colorPrimary"
    app:hl_shapeMode="selected">
    <!-- 不再使用 hl_bindTextView 等属性 -->
```

## 📋 测试步骤

### 步骤1：准备测试环境
1. 确保设备上有多个本地视频文件
2. 打开XMBOX应用
3. 进入"本地播放"功能

### 步骤2：测试竖屏选集弹窗
1. 在竖屏模式下播放任意视频
2. 点击播放器控制器中的"选集"按钮
3. **验证**：
   - 弹窗正常显示
   - 所有按钮都有文字内容
   - 文字清晰可见

### 步骤3：测试横屏选集弹窗
1. 切换到横屏模式（点击横竖屏切换按钮）
2. 点击播放器控制器中的"选集"按钮
3. **验证**：
   - 弹窗从右侧弹出
   - **重点检查**：所有按钮都显示文字内容
   - 文字大小适中，清晰可读
   - 6列网格布局正常

### 步骤4：测试选中状态
1. 在横屏模式下点击任意集数按钮
2. **验证**：
   - 选中的按钮背景变为主题色
   - 选中的按钮文字变为白色
   - 其他按钮保持深灰色文字

### 步骤5：测试切换功能
1. 多次在横竖屏之间切换
2. 每次都打开选集弹窗
3. **验证**：
   - 文字显示始终正常
   - 布局适配正确
   - 选中状态保持正确

## ✅ 预期效果

### 修复前
- 横屏模式下按钮无文字显示
- 用户无法识别集数
- 选集功能基本不可用

### 修复后
- 横屏模式下文字正常显示
- 文字大小适中，清晰可读
- 选中状态明显，用户体验良好

## 🐛 故障排除

### 问题1：文字仍然不显示
**可能原因**：
- 数据传递问题
- 主题颜色资源缺失

**解决方法**：
1. 检查logcat中的调试信息
2. 重启应用
3. 清除应用数据

### 问题2：文字颜色不正确
**可能原因**：
- 主题切换影响
- 颜色资源未正确加载

**解决方法**：
1. 切换到其他主题再切换回来
2. 重启应用

### 问题3：布局显示异常
**可能原因**：
- 屏幕尺寸计算问题
- 网格布局参数错误

**解决方法**：
1. 旋转屏幕重新触发布局
2. 关闭重新打开弹窗

## 📊 调试信息

应用会在logcat中输出以下调试信息：
```
D/AllLocalSeriesDialog: 数据列表大小: X
D/AllLocalSeriesDialog: 第0项: name=XXX, selected=true/false
```

如果看不到这些信息，说明弹窗没有正确创建或数据传递有问题。

## 🎉 功能优势

1. **完整的文字显示**：横屏模式下所有按钮都有文字
2. **清晰的视觉反馈**：选中状态明显
3. **响应式设计**：适配不同屏幕方向
4. **一致的用户体验**：横竖屏下行为一致
5. **优化的布局**：合理的网格列数和文字大小

现在横屏模式下的选集弹窗应该能正常显示文字了！请测试一下这个修复。
